<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Qwik training</title>

    <link rel="stylesheet" href="../dist/reset.css">
    <link rel="stylesheet" href="../dist/reveal.css">
    <link rel="stylesheet" href="../dist/theme/white.css">
    <link rel="stylesheet" href="./slides.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="../plugin/highlight/monokai.css">

    <link rel='stylesheet' id='font-family-1-css'
          href='https://fonts.googleapis.com/css2?family=Poppins%3Awght%40300%3B400%3B600%3B700&#038;display=swap&#038;ver=005bbd'
          type='text/css' media='all'/>
    <link rel="icon" type="image/png" href="./images/qwik-logo.svg">
</head>
<body class="global">

<div class="reveal">
    <div class="slides">
        <section>
            <section data-state="se-connaitre">
                <h1>Qwik</h1>
                <aside class="notes">
                    <ul>
                        <li>Présentation formateur</li>
                        <li>Un tour de table</li>
                        <li>Votre niveau en HTML / JS / CSS ?</li>
                        <li>Framework web JS</li>
                        <li>Chargement "instantané" quelle que soit la taille/complexité de l'application</li>
                        <li>Nécessite uniquement 1Ko de JS pour commencer à fonctionner</li>
                        <li>JSX</li>
                    </ul>
                </aside>
            </section>
            <section data-state="historique">
                <h2>Pourquoi et comment ?</h2>
                <p class="fragment">
                    <img src="./images/builder-io.webp" style="height: 200px;">
                </p>
                <p class="fragment">
                    Optimisation de toutes les applications clientes
                </p>
                <aside class="notes">
                    <ul>
                        <li>Miško Hevery, créateur d'AngularJS et Angular</li>
                        <li>Manu Almeida, core team ionic</li>
                        <li>Adam Bradley, Director of technology chez ionic</li>
                    </ul>
                </aside>
            </section>
            <section data-state="historique">
                <a href="https://qwik.dev/docs/">Documentation</a>
                <a href="hhttps://qwik.dev/tutorial/welcome/overview/">Tutoriel</a>
            </section>
        </section>

        <section data-state="base">
            <section>
                <h2>Qwik niveau 1</h2>
            </section>
            <section data-state="pr-robot">
                <p>Pré-requis minimums</p>
                <ul>
                    <li>Node.js 18+</li>
                    <li>NPM v10.7.0+</li>
                    <li>Git</li>
                </ul>
            </section>
            <section>
                <p>Création de l'application power ranger</p>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/01-create-app/README.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Correction : 01-Première-application</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Structure du projet</p>
                <div w3-include-html="./code/01-structure.html"></div>
                <aside class="notes">
                    <ul>
                        <li>README.md
                        <li>package.json
                        <li>public -> Contient des fichiers statiques qui seront copiés dans le dossier dist</li>
                        <li>src -> Contient le code de l'application</li>
                        <li>components -> Les composants qwik</li>
                        <li>entry.ssr.tsx -> Point d'entrée pour le serveur afin de générer le HTML initial de
                            l'application avant de l'envoyer au client
                        </li>
                        <li>global.css -> Fichier CSS global</li>
                        <li>root.tsx -> Premier composant qui sera rendu</li>
                        <li>routes -> L'annuaire des routes de l'application</li>
                        <li>index.tsx -> Page d'accueil</li>
                        <li>layout.tsx -> La mise en page racine</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Framework composant</p>
                <p>Assemblage de composants donne une page</p>
                <div w3-include-html="./code/01-component-simple.html"></div>
                <p>1 seul élément par composant (<> operator)</p>
                <aside class="notes">
                    <ul>
                        <li>On va créer un arbre de composants</li>
                        <li>La version la plus simple d'un composant</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Évènements</p>
                <div w3-include-html="./code/01-component.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Montrer comment un composant qwik est formé</li>
                        <li>Montrer handler</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Données</p>
                <div w3-include-html="./code/01-component-avec-props.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/02-first-component/README.html"></div>
            </section>
            <section>
                <p>Rendu avec des conditions, des listes et du binding</p>
                <ul>
                    <li class="fragment">if/else, ternaire et &&</li>
                    <li class="fragment">map et key</li>
                    <li class="fragment">Binding attribute</li>
                </ul>

            </section>
            <section>
                <div w3-include-html="./code/01-conditions.html"></div>
            </section>
            <section>
                <div w3-include-html="./code/01-conditions-ternaire.html"></div>
            </section>
            <section>
                <div w3-include-html="./code/01-conditions-map.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/03-condition/README.html"></div>
            </section>
            <section>
                <p>Signal et Store</p>
                <p class="fragment">Lier une variable avec ce qui est dans le template</p>
                <p class="fragment">Pour une variable "atomique" / un objet complexe</p>
            </section>
            <section>
                <div w3-include-html="./code/01-signal.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Modifier dynamiquement le template</li>
                        <li>Montrer la différence</li>
                        <li>option deep permettant de suivre uniquement les propriétés de niveau supérieur, perf</li>
                        <li>utiliser useSignal sinon le bind ne fonctionnera pas !</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/04-signal/README.html"></div>
            </section>
            <section data-state="tp">
                <p>Suite du TP</p>
                <div w3-include-html="./tp/niveau1/05-store/README.html"></div>
            </section>
            <section>
                <p>CSS modules et CSS global</p>
                <ul>
                    <li class="fragment">Le CSS global est utilisé pour les styles qui doivent être appliqués sur tout
                        le site
                    </li>
                    <li class="fragment">Le CSS module est utilisé pour les styles qui doivent être appliqués sur un
                        composant
                    </li>
                </ul>
            </section>
            <section>
                <div w3-include-html="./code/01-css.html"></div>
                <aside class="notes">
                    <ul>
                        <li>utilisation des css module</li>
                        <li>Importer du CSS sous forme de chaîne dans Vite, vous devez ajouter le ?inline paramètre de
                            requête à l'importation
                        </li>
                        <li>scoped</li>
                        <li>inline</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/06-css/README.html"></div>
            </section>
            <section>
                <p>Slot</p>
                <div w3-include-html="./code/01-slot.html"></div>
            </section>
            <section>
                <p>Et les tests</p>
                <div w3-include-html="./code/01-tests.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau1/07-test/README.html"></div>
            </section>
        </section>
        <section data-state="medium">
            <section>
                <h2>Qwik niveau 2</h2>
            </section>
            <section>
                <p>Contextes</p>
                <div w3-include-html="./code/02-context.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Déclaration de l'id</li>
                        <li>ce qu'on peut mettre ou pas</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/01-context/README.html"></div>
            </section>

            <section>
                <p>Qwik City - routing</p>
                <div w3-include-html="./code/02-routing.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Se basse sur le dossier routes</li>
                        <li>Layout serra utilisé pour les routs au même niveau</li>
                        <li>Slot permet de projeter ces enfants dans l'arborescence DOM</li>
                        <li>Récupération de données avec useLocation</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/02-routing/README.html"></div>
            </section>
            <section>
                <p>Pour récupération de la donnée passé dans l'url</p>
                <div w3-include-html="./code/02-location.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/03-routing-dynamic/README.html"></div>
            </section>
            <section>
                <p>Qwik City - Navigation SPA/MPA</p>
                <div w3-include-html="./code/02-link.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/04-link/README.html"></div>
            </section>
            <section>
                <p>Navigation MPA ou SPA 🧐</p>
            </section>
            <section data-state="tp">
                <p>Prevent default</p>
                <div w3-include-html="./code/02-prevent.html"></div>
            </section>
            <section>
                <p>Qwik City - routeLoaders$</p>
                <div w3-include-html="./code/02-route-loader.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Récupération de donnée pour le composant ...</li>
                        <li>Ce code ne s'exécute que sur le serveur, après chaque navigation</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/06-route-loader/README.html"></div>
            </section>
            <section>
                <p>Qwik City - DocumentHead</p>
                <div w3-include-html="./code/02-head.html"></div>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/07-head/README.html"></div>
            </section>
            <section>
                <p>Qwik City - useResource$</p>
                <div w3-include-html="./code/02-use-resource.html"></div>
                <p>track: recherche avec filtres, ...</p>
                <p>cleanup: destruction de websocket, ...</p>
            </section>
            <section>
                <p>Qwik City - Resources</p>
                <div w3-include-html="./code/02-resource.html"></div>
                <aside class="notes">
                    <ul>
                        <li> Il est souvent souhaitable de commencer à récupérer les données sur le serveur dans le
                            cadre de la requête HTTP initiale avant le rendu du composant
                        </li>
                        <li>Il s'agit plutôt d'une API de bas niveau qui est utile lorsque vous souhaitez récupérer
                            des données dans le navigateur
                        </li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>TP</p>
                <div w3-include-html="./tp/niveau2/08-resource/README.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Si le loading ne s'affiche pas, c'est à cause du fait que la page est générée en SSR.</li>
                        <li>cf <a href="https://github.com/QwikDev/qwik/issues/4328">ce ticket</a></li>
                    </ul>
                </aside>
            </section>
        </section>

        <section data-state="why-qwik-so-cool">
            <section>
                <h2>Les atouts de Qwik</h2>
                <p class="fragment">Pourquoi est-il aussi mé... euh cool</p>
            </section>

            <section>
                <h2>Performance Web</h2>
                <p class="fragment">... et empreinte carbone</p>
            </section>
            <section data-state="green">
                <h2>Empreinte et performance</h2>
                <p class="fragment fade-in">1 Mo envoyé = 15 g de CO2 (et c'est déjà un début)</p>
                <p class="fragment fade-in">Attention (activité backend, optimisations: caches, génération statique,
                    ...)</p>
                <aside class="notes">
                    <p>On a parlé jusque-là de performances, mais quel rapport avec l'empreinte carbone ?</p>
                    <p>Plus de code = plus de transit = plus de consommation</p>
                    <p>Multiplié par le nombre de visites ou d'utilisateurs</p>
                </aside>
            </section>
            <section>
                <img src="./images/fcp.png" style="max-height: 400px">
                <aside class="notes">
                    <p>FP: First Painting (On commence à "sentir" de site web arriver)</p>
                    <p>FMP: First MeaningFul Painting (On peut commencer à lire, vue générale)</p>
                    <p>TTI: Time to Interactive(On peut interagir, Si l'utilisateur est resté jusque-là c'est gagné)</p>
                </aside>
            </section>
            <section>
                <img src="./images/fcp-why.png" style="height: 600px">
                <aside class="notes">
                    <div>Correspond à des évènements techniques</div>
                    <div>FP: chargement de la page html uniquement</div>
                    <div>FMP: page html + rendu JS si besoin</div>
                    <div>TTI: page html + rendu JS + écouteurs dévènements</div>
                </aside>
            </section>

            <section>
                <h2>Les types de rendu web</h2>
                <aside class="notes">
                    <div>Partant de ces définitions, on a utilisé dans le temps plusieurs façons de faire pour essayer
                        d'améliorer l'UX utilisateur
                    </div>
                </aside>
            </section>
            <section>
                <table class="legacy">
                    <tbody>
                    <tr>
                        <td>
                            <p>Statique</p>
                        </td>
                        <td>
                            <img src="./images/app1.png" class="app-size">
                        </td>
                        <td class="rating">
                            <div class="center-image">
                                <p>Interactivité</p>
                                <img src="./images/star.png" class="rate ml-auto">
                            </div>
                            <div class="center-image">
                                <p>FMP</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>TTI</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                        </td>
                    </tr>
                    <tr class="fragment">
                        <td>
                            <p>Généré</p>
                        </td>
                        <td>
                            <img src="./images/app2.png" class="app-size">
                        </td>
                        <td class="rating">
                            <div class="center-image">
                                <p>Interactivité</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>FMP</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>TTI</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                        </td>
                    </tr>
                    <tr class="fragment">
                        <td>
                            <p>CSR</p>
                        </td>
                        <td>
                            <img src="./images/app3.png" class="app-size">
                        </td>
                        <td class="rating">
                            <div class="center-image">
                                <p>Interactivité</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>FMP</p>
                                <img src="./images/star.png" class="rate ml-auto">
                            </div>
                            <div class="center-image">
                                <p>TTI</p>
                                <img src="./images/star.png" class="rate ml-auto">
                            </div>
                        </td>
                    </tr>
                    <tr class="fragment">
                        <td>
                            <p>SSR / (Partial) Hydratation</p>
                        </td>
                        <td>
                            <img src="./images/app4.png" class="app-size">
                        </td>
                        <td class="rating">
                            <div class="center-image">
                                <p>Interactivité</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>FMP</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>TTI</p>
                                <img src="./images/star.png" class="rate ml-auto">
                            </div>
                        </td>
                    </tr>
                    <tr class="fragment">
                        <td>
                            <p>SSR (Resumability) (<img src="./images/qwik.png" class="qwik-logo small">)</p>
                        </td>
                        <td>
                            <img src="./images/app5.png" class="app-size">
                        </td>
                        <td class="rating">
                            <div class="center-image">
                                <p>Interactivité</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>FMP</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                            <div class="center-image">
                                <p>TTI</p>
                                <img src="./images/star.png" class="rate ml-auto">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                                <img src="./images/star.png" class="rate">
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <aside class="notes">
                    <h3>Statique</h3>
                    <p>Très performant, et responsable</p>
                    <p>Pas ou peu d'interactions</p>
                    <h3>Généré</h3>
                    <p>Moins bien niveau perf (il faut générer la page avant de la servir)</p>
                    <p>Plus d'interactions</p>
                    <h3>CSR</h3>
                    <p>Interactions bien supérieures</p>
                    <p>Performances "s'écroulent" FMP et TTI</p>
                    <h3>SSR avec hydratation</h3>
                    <p>Données envoyées 2 fois (HTML ET JS) et calculées 2 fois</p>
                    <p>TTI très long (reconstruction de l'ensemble de la page avant interaction même si déjà
                        constuite)</p>
                    <h3>Résumabilité</h3>
                    <p>Grosse amélioration TTI</p>
                    <p>Optimisations de ce qui est possible en plus</p>
                    <div>Do better by doing (almost) nothing !</div>
                    <div>Qwik ne demande pas d'effort au développeur !</div>
                </aside>
            </section>
            <section data-state="robot">
                <h2>Résumabilité</h2>
                <p class="fragment">Relancer la navigation en exécutant le minimum de choses</p>
                <p class="fragment fade-in">Télécharger le moins de choses possible</p>
                <p class="fragment fade-in">... tout en gardant une réactivité accrue</p>
            </section>
            <section data-state="robot">
                <h2>QwikLoader</h2>
                <p class="fragment">1kB de Javascript</p>
                <p class="fragment fade-in">uniquement des handlers généraux</p>
                <p class="fragment fade-in">... uniquement ceux nécessaires</p>
            </section>
            <section data-state="robot">
                <p>Comment ça marche ?</p>
                <img src="./images/onevent.png" style="height: 250px;">
                <aside class="notes">
                    <div>Qwik ne va télécharger le JS qu'au moment où il en a besoin !</div>
                </aside>
            </section>
            <section data-state="robot">
                <img src="./images/lazy.png" style="height: 250px;">
            </section>
            <section data-state="robot">
                <h2>Le nécessaire</h2>
                <ul>
                    <li class="fragment">Etat minimisé</li>
                    <li class="fragment">Dépendances entre fragments</li>
                    <li class="fragment">Références aux interactions/render</li>
                    <li class="fragment">JS nécessaire (useVisibleTask$, ...)</li>
                </ul>
            </section>
            <section data-state="robot">
                <h2>État minimisé</h2>
                <div w3-include-html="./code/03-state.html"></div>
                <aside class="notes">
                    <p>Type spécifique, compris par Qwik uniquement</p>
                    <p>On devine les références au code Javascript</p>
                    <p>On devine les dépendances entre fragments</p>
                </aside>
            </section>
            <section data-state="robot">
                <p>Lisible avec <a href="https://qwik.dev/docs/labs/devtools/">Qwik Devtools</a></p>
                <pre class="code-wrapper" data-id="code-animation">
                <code data-trim data-line-numbers="1-16|3-5|7" class="code-font-sm">
                        import("https://qwik.dev/devtools/json/");
                </code>
                </pre>
                <img class="fragment" src="./images/devtools.png" style="height: 250px;">
            </section>
            <section>
                <p>Description du résultat</p>
                <ul>
                    <li class="fragment">objs: Les objects du système qui ont été sérialisés</li>
                    <li class="fragment">ctx: Un ensemble d'objets QContext.</li>
                    <li class="fragment">refs: un esemble d'objets QRef.</li>
                    <li class="fragment">sub: un ensemble d'objets QSubscription.</li>
                </ul>
                <aside class="notes">
                    <ul>
                        <li>QContext: Un état que Qwik a sérialisé pour un composant donné. Inclut les props du
                            composant et un ensemble d'objets Task qui pourraient être exécutées par le composant.
                        </li>
                        <li>QRef: Si un élément a un observateur, alors la QRef rassemble tous les observateurs ainsi
                            que les objets qui ont pu être capturés par eux.
                        </li>
                        <li>Qwik ne sérialise que les objets atteignables depuis un QContext, ou depuis une QRef.</li>
                    </ul>
                </aside>
            </section>
            <section data-state="robot">
                <p>et dans le html...</p>
                <div w3-include-html="./code/03-state-html.html"></div>
                <aside class="notes">
                    <p>il utilise ses références et son markup pour le rendu</p>
                    <p>il utilise ses links js avec références pour les exécutions</p>
                    <ul>
                        <li>Le framework est responsable de ces optimisations</li>
                        <li>Uniquement la partie nécessaire de l'application est envoyée</li>
                        <li>En particulier, on n'envoie pas un contenu obtenu par API qui ne peut plus changer !</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <h2>TP</h2>
                <div w3-include-html="./tp/niveau3/01-lazy/README.html"></div>
            </section>

            <section>
                <h2>Lazy Lazy loading</h2>
            </section>
            <section>
                <p>Un composant Qwik</p>
                <div w3-include-html="./code/03-component.html"></div>
                <aside class="notes">
                    <div>Exemple tout simple de composant</div>
                </aside>
            </section>
            <section>
                <p>... et sa version "compilée"</p>
                <div w3-include-html="./code/03-compiled.html"></div>
                <aside class="notes">
                    <p>Séparation en fichiers séparés</p>
                    <p>De là viennent des contraintes à respecter... (imaginons Closures, paramètres, ...)</p>
                </aside>
            </section>
            <section data-auto-animate>
                <blockquote cite="https://qwik.builder.io/docs/advanced/dollar/">
                    <p>Not all valid JavaScript code is valid code for the Optimizer.</p>
                    <footer class="code-font-sm">—Qwik documentation, <cite>The $ dollar sign</cite></footer>
                </blockquote>
            </section>
            <section data-auto-animate>
                <blockquote cite="https://qwik.builder.io/docs/advanced/dollar/">
                    <p>Not all valid JavaScript code is valid code for the Optimizer.</p>
                    <footer class="code-font-sm">—Qwik documentation, <cite>The $ dollar sign</cite></footer>
                </blockquote>
                <div w3-include-html="./code/03-invalid.html"></div>
                <aside class="notes">
                    <p>Invalide car non exporté</p>
                    <p>Valides sinon</p>
                </aside>
            </section>
            <section data-auto-animate>
                <blockquote cite="https://qwik.builder.io/docs/advanced/dollar/">
                    <p>Not all valid JavaScript code is valid code for the Optimizer.</p>
                    <footer class="code-font-sm">—Qwik documentation, <cite>The $ dollar sign</cite></footer>
                </blockquote>
                <div w3-include-html="./code/03-invalid-2.html"></div>
                <aside class="notes">
                    <p>Pas de let</p>
                    <p>Pas de classes (sérializable)</p>
                </aside>
            </section>

            <section>
                <h2>Dès le début ?</h2>
                <p>useOn, useOnDocument, useOnWindow</p>
                <div w3-include-html="./code/03-useon.html"></div>
                <aside class="notes">
                    <p>Des fois on a besoin d'exécuter des choses sans action utilisateur (slideshow, ...)</p>
                    <ul>
                        <li>useOn* permet d'écouter les évènements de chaque container directement</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h2>Dès le début ?</h2>
                <p>useTask$ (côté serveur, avant rendering, no delay)</p>
                <div w3-include-html="./code/03-usetask.html"></div>
                <aside class="notes">
                    <ul>
                        <li>useTask$: exécution en mode SSR</li>
                    </ul>
                </aside>
            </section>
            <section>
                <h2>Dès le début ?</h2>
                <p class="fade-in red">useVisibleTask$</p>
                <div w3-include-html="./code/03-use-visible-task.html"></div>
                <aside class="notes">
                    <ul>
                        <li>useVisibleTask$: exécution en mode CSR, mais attention, bloque le main thread !</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <h2>TP</h2>
                <div w3-include-html="./tp/niveau3/02-use/README.html"></div>
                <aside class="notes">
                    <a href="https://qwik.dev/docs/guides/best-practices/#use-usevisibletask-as-a-last-resort">Avoid
                        Visible tasks</a>
                    <ul>
                        <li class="fragment">utiliser useOnDocument</li>
                        <li class="fragment">utiliser useLocation</li>
                        <li class="fragment">useVisibleTask + un setInterval</li>
                        <li class="fragment">attention sérialisation !</li>
                    </ul>
                </aside>
            </section>
        </section>

        <section data-state="qwik-backend">
            <section>
                <h2>Qwik Backend</h2>
                <p>Tout au même endroit</p>
            </section>
            <section>
                <p>routeActions$ / globalActions$</p>
                <ul>
                    <li class="fragment">Fonctions serveur appelées explicitement</li>
                    <li class="fragment">Avec side-effect (BDD, email, submit...)</li>
                    <li class="fragment">Retourne de la donnée au client</li>
                </ul>
            </section>
            <section>
                <p>Avec un form</p>
                <div w3-include-html="./code/04-form.html"></div>
                <aside class="notes">
                    <ul>
                        <li>npm install @modular-forms/qwik</li>
                        <li>Utilisation de Form (Qwik-City)</li>
                        <li>Fonctionnera même sans JS. Avec JS, la navigation est en mode SPA</li>
                        <li>On peut coupler avec des event handlers type onSubmitCompleted$ pour par exemple reset un
                            formulaire
                        </li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Programmatiquement</p>
                <div w3-include-html="./code/04-form-p.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Pour déclencher sur ce qu'on a envie</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Validation de formulaires</p>
                <div w3-include-html="./code/04-form-valid.html"></div>
                <aside class="notes">
                    <ul>
                        <li>Permet de valider ce qu'on a en entrée</li>
                        <li>zod est built-in dans Qwik</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Accès à la request</p>
                <div w3-include-html="./code/04-request.html"></div>
                <aside class="notes">
                    <ul>
                        <li>on a bien l'auth etc...</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Gestion des erreurs</p>
                <div w3-include-html="./code/04-errors.html"></div>
                <aside class="notes">
                    <ul>
                        <li>failed est mis à true en cas d'erreur</li>
                        <li>fieldErrors contient l'objet ayant provoqué l'erreur</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Précédentes valeurs</p>
                <div w3-include-html="./code/04-previous.html"></div>
                <aside class="notes">
                    <ul>
                        <li>formData contient le précédent formulaire</li>
                        <li>par exemple si on veut persister... même sans JS</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Route vs Global ?</p>
                <ul>
                    <li class="fragment">`routeAction$()` uniquement dans le dossier `src/routes`</li>
                    <li class="fragment">Uniquement sur les routes où elle est déclarée</li>
                    <li class="fragment">Doit être exportée</li>
                    <li class="fragment">`globalAction$()` partout dans le dossier `src`</li>
                </ul>
                <aside class="notes">
                    <ul>
                        <li>on oppose aussi souvent les actions qui ont besoin de l'utilisateur connecté ou non</li>
                        <li>routeAction$: formulaire / globalAction$: login</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau4/01-route-action/README.html"></div>
            </section>
            <section>
                <p>Avec Modular Form</p>
                <div w3-include-html="./code/02-forms.html"></div>
            </section>
            <section>
                <p>TP</p>
                <div w3-include-html="./tp/niveau4/05-form/README.html"></div>
            </section>
            <section>
                <p>Middlewares</p>
                <aside class="notes">
                    <ul>
                        <li>Permet de faire de la chain logic (auth, security, cache, redirects, logging)</li>
                        <li>se déclare dans un `layout.tsx` ou `index.tsx` ou un `plugin@some-name.ts`</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Exemple</p>
                <div w3-include-html="./code/04-previous.html"></div>
            </section>
            <section>
                <p>Spécifique à une méthode</p>
                <div w3-include-html="./code/04-method.html"></div>
            </section>
            <section>
                <p>Ordre d'invocation</p>
                <div w3-include-html="./code/04-order.html"></div>
                <aside class="notes">
                    <ul>
                        <li>On prends tous les layouts dans l'ordre de descente dans l'arbre</li>
                        <li>On finit par l'index.tsx feuille de la route en question</li>
                        <li>Oui, on peut avoir des endpoints dans le index.tsx qui contient un composant. Les fonctions
                            seront appelées avant le rendreing
                        </li>
                        <li>Si plusieurs middlewares dans le même fichier: onRequest, puis (onGet, onPost, onPut,
                            onPatch, et onDelete)
                        </li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>RequestEvent</p>
                <div w3-include-html="./code/04-request-event.html"></div>
                <aside class="notes">
                    <ul>
                        <li>RequestEvent contient toutes sortes de fonctions utilitaires</li>
                        <li>next => passe au prochain dans la chaîne</li>
                        <li>sharedMap => rend dispo des informations</li>
                        <li>headers, cookies, method, url, params, query => self-explain</li>
                        <li>text(), html(), json(), send(), exit(), redirect() => pour gérer le retour si besoin</li>
                        <li>il y en a tout un tas: https://qwik.dev/docs/middleware/#requestevent</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau4/02-middleware/README.html"></div>
            </section>

            <section>
                <p>Endpoints</p>
                <div w3-include-html="./code/04-endpoints.html"></div>
                <aside class="notes">
                    <ul>
                        <li>C'est un middleware qui retourne une réponse</li>
                        <li>Peut accéder à une BDD pour retourner une liste, faire un reverse proxy etc...</li>
                    </ul>
                </aside>
            </section>
            <section>
                <p>Répondre progressivement</p>
                <div w3-include-html="./code/04-endpoints-p.html"></div>
                <aside class="notes">
                    <ul>
                        <li>C'est un middleware qui retourne une réponse</li>
                        <li>Peut accéder à une BDD pour retourner une liste, faire un reverse proxy etc...</li>
                    </ul>
                </aside>
            </section>

            <section>
                <p>server$</p>
                <div w3-include-html="./code/04-server.html"></div>
                <aside class="notes">
                    <ul>
                        <li>On peut aussi faire de la réponse progressive avec server$ (mais avec des fonctions
                            asynchrone génératrices (async function*, yield, ...)
                        </li>
                        <li>Endpoint est plus bas niveau - plus utile pour être une vraie API externe</li>
                        <li>server$ meilleur pour exécuter du code et le renvoyer côté client (fortement typé et
                            meilleure API pour faire ça
                        </li>
                        <li>seuls les middlewares issus de plugin.tsx sont exécutés</li>
                    </ul>
                </aside>
            </section>

            <section>
                <p>Répondre progressivement...</p>
                <div w3-include-html="./code/04-server-p.html"></div>
            </section>

            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau4/03-endpoint/README.html"></div>
            </section>

            <section>
                <p>validator$ (server-side)</p>
                <div w3-include-html="./code/04-ss-validator.html"></div>
                <div class="fragment">Attention, vous pouvez modifier ce qui est donné au prochain validateur/endpoint
                </div>
                <aside class="notes">
                    <ul>
                        <li>Permet de valider les entrées, headers, ...</li>
                        <li>Exécutés du bas vers le haut</li>
                    </ul>
                </aside>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau4/04-validator/README.html"></div>
            </section>
        </section>

        <section data-state="quiz">
            <section>
                <h2>Qwizz</h2>
            </section>
            <section data-quiz>
                <h3>Quel est le concept-clé de Qwik ?</h3>
                <p class="fragment green">La Résumabilité</p>
            </section>
            <section data-quiz>
                <h3>Quel est son pricipal avantage ?</h3>
                <p>Il est plus puissant</p>
                <p class="fragment highlight-green">Il est plus fainéant</p>
                <p class="fragment highlight-green">Il est plus intelligent</p>
                <aside class="notes">
                    Sa grande force réside dans toutes les choses qu'il évite de charger / d'exécuter
                </aside>
            </section>
            <section data-quiz>
                <h3>Ce code est-il valide ?</h3>
                <div w3-include-html="./code/05-qwizz-1.html"></div>
                <p>Oui</p>
                <p class="fragment highlight-green">Non</p>
                <aside class="notes">
                    On ne peut pas sérialiser un BroadcastChannel
                </aside>
            </section>
            <section data-quiz>
                <h3>Ce code est-il valide ?</h3>
                <div w3-include-html="./code/05-qwizz-2.html"></div>
                <p class="fragment highlight-green">Oui</p>
                <p>Non</p>
                <p class="fragment">
                    Mais ce n'est pas pertinent pour autant
                </p>
                <aside class="notes">
                    Alors le retour d'un setTimeout est un entier, donc techniquement sérializable.
                    Cependant, si on exécute le setTimeout côté server pour le transférer côté client...
                </aside>
            </section>
            <section data-quiz>
                <h3>Ce code est exécuté ?</h3>
                <div w3-include-html="./code/05-qwizz-4.html"></div>
                <p class="fragment highlight-green">Côté client</p>
                <p>Côté serveur</p>
                <p>Les 2</p>
                <aside class="notes">
                    Use on Document permet de déposer un listener sur document
                    Use Visible task attends spécifiquement l'apparition du composant dans la vue
                    Exemples: setTimeout après affichage, ...
                </aside>
            </section>
            <section data-quiz>
                <h3>Ce code est exécuté ?</h3>
                <div w3-include-html="./code/05-qwizz-5.html"></div>
                <p>Côté client</p>
                <p class="fragment highlight-green">Côté serveur</p>
                <p>Les 2</p>
                <p class="fragment">
                    Même si on fait de la navigation côté client, cette partie reste déportée sur le serveur
                </aside>
            </section>
            <section data-quiz>
                <h3>Ce code est exécuté ?</h3>
                <div w3-include-html="./code/05-qwizz-3.html"></div>
                <p>Côté client</p>
                <p>Côté serveur</p>
                <p class="fragment highlight-green">Les 2</p>
                <p class="fragment">
                    Pendant le rendu, mais en MPA ou SPA
                </p>
            </section>
        </section>

        <section data-state="bonus">
            <section>
                <h2>Bonus stage</h2>
            </section>
            <section>
                <h2><a href="https://qwik.builder.io/docs/integrations/image-optimization/" target="_blank">Image
                    Optimisation</a></h2>
                <p class="fragment">Optimisation automatique et poussée des images (featuring Vite)</p>
            </section>
            <section>
                <div w3-include-html="./code/06-image.html"></div>
                <aside class="notes">
                    <div>import de composant avec ?jsx à la fin</div>
                    <div>Pas d'autres déclarations à faire</div>
                </aside>
            </section>
            <section>
                <div w3-include-html="./code/06-image-compiled.html"></div>
                <aside class="notes">
                    <div>lazy load automatique</div>
                    <div>utilisation de srcset avec différentes tailles</div>
                    <div>images mises à disposition automatiquement sous différentes résolution</div>
                </aside>
            </section>
            <section>
                <h2><a href="https://qwik.dev/docs/integrations/react/#qwik-react-%EF%B8%8F">Qwik-React</a></h2>
                <p class="fragment">Migrer depuis une application React sans tout réécrire dès le début</p>
            </section>
            <section>
                <div w3-include-html="./code/06-react.html"></div>
            </section>
            <section>
                <p>Existe aussi pour:</p>
                <ul>
                    <li class="fragment"><a href="https://github.com/QwikDev/qwik-angular">Angular</a></li>
                    <li class="fragment"><a href="https://github.com/mizchi/qwik-vue">Vue</a></li>
                </ul>
                <p class="fragment">Attention à la maturité</p>
                <p class="fragment">Attention à l'utilisabilité (instances de services, ...)</p>
            </section>
            <section>
                <h2><a href="https://qwik.dev/docs/integrations/#integrations">Integrations</a></h2>
                <p class="fragment">Power-ups</p>
            </section>
            <section>
                <ul>
                    <li><a href="https://qwik.dev/docs/integrations/authjs/">Auth.js</a> pour le backend</li>
                    <li><a href="https://qwik.dev/docs/integrations/i18n/">i18n ($localize ou qwik-speak)</a></li>
                    <li>Storybook, Tailwind, Leaflet...</li>
                </ul>
            </section>
            <section>
                <h2><a href="https://qwik.dev/docs/deployments/">Deployments</a></h2>
                <p class="fragment">Easy mode</p>
            </section>
            <section>
                <ul>
                    <li><a href="https://qwik.dev/docs/deployments/node/">Node</a></li>
                    <li>Google Cloud Run, Deno, Bun, AWS, Firebase, ...</li>
                    <li><a href="https://qwik.dev/docs/deployments/static/">Static Site</a></li>
                </ul>
            </section>
            <section data-state="tp">
                <p>TP</p>
                <div w3-include-html="./tp/niveau5/01-node/README.html"></div>
                <div w3-include-html="./tp/niveau5/02-ssg/README.html"></div>
            </section>
            <section>
                <h2><a href="https://qwik.dev/docs/integrations/partytown/#partytown">Partytown</a></h2>
                <p class="fragment">Mécanisme pour éjecter les scripts tiers du temps de chargement de la page sans pour
                    autant les supprimer entièrement</p>
            </section>
            <section>
                <div w3-include-html="./code/06-partytown.html"></div>
            </section>
        </section>
    </div>
</div>

<script src="../dist/reveal.js"></script>
<script src="../plugin/notes/notes.js"></script>
<script src="../plugin/markdown/markdown.js"></script>
<script src="../plugin/highlight/highlight.js"></script>
<script type="module">
    import RevealGamepadController from "../plugin/reveal-gamepad-controller-plugin/dist/index.js";
    import RevealProgressImage from "../plugin/reveal-progress-image-plugin/dist/index.js";

    const urlParams = new URLSearchParams(window.location.search);
    const receiver = urlParams.get('receiver');
    const pluginOnlyOnMain = receiver !== null ? [] : [RevealGamepadController(Reveal)];

    const progressPlugin = RevealProgressImage(Reveal);

    setTimeout(() => {
        Reveal.initialize({
            hash: true,
            progress: true,
            progressImage: {
                iconSize: [60, 60],
                imageAnimation: progressPlugin.ANIMATIONS.CIRCULAR_FLY
            },
            imageSrc: './images/lightening.png',
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes, ...pluginOnlyOnMain, progressPlugin],
        });

        function includeHTML() {
            var z, i, elmnt, file, xhttp;
            /* Loop through a collection of all HTML elements: */
            z = document.getElementsByTagName("*");
            for (i = 0; i < z.length; i++) {
                elmnt = z[i];
                /*search for elements with a certain atrribute:*/
                file = elmnt.getAttribute("w3-include-html");
                if (file) {
                    /* Make an HTTP request using the attribute value as the file name: */
                    xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function () {
                        if (this.readyState == 4) {
                            if (this.status == 200) {
                                elmnt.innerHTML = this.responseText;
                                elmnt.querySelectorAll('pre code').forEach((block) => {
                                    Reveal.getPlugins()['highlight'].hljs.highlightElement(block);
                                })
                            }
                            if (this.status == 404) {
                                elmnt.innerHTML = "Page not found.";
                            }
                            /* Remove the attribute, and call this function once more: */
                            elmnt.removeAttribute("w3-include-html");
                            includeHTML();
                        }
                    }
                    xhttp.open("GET", file, true);
                    xhttp.send();
                    /* Exit the function: */
                    return;
                }
            }
        }

        includeHTML();
    }, 1000);
</script>
</body>
</html>

